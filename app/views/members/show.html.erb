<%- content_for :title do -%><%= @member.handle %> | Members | <%- end -%>

<%= content_section 'member-info' do -%>
    <% record_cache @member do %>
        <%= member_avatar @member, img: {class: 'z-shadow-1'}, link: false, handle: false %>
        <%- twitch_link = nil -%>
        <div class="member-external-links z-shadow-1">
            <%- @member.external_links.each do |el| -%>
                <%= link_to external_link_icon(el), external_link_resource_url(el) %>
                <%- twitch_link = el if el.site == 'twitch' -%>
            <%- end -%>
        </div>
        <h2><%= @member.handle %></h2>
        <%- unless twitch_link.nil? then -%>
            <%- fragment = twitch_link.fragment -%>
            <a
                class="member-twitch-indicator z-shadow-1"
                href="<%= external_link_twitch_channel_url fragment %>"
                data-fragment="<%= fragment %>"
            >
                <span>Live Now @ Twitch:&nbsp;&nbsp;<span class="twitch-info-title"></span></span>
                <span>Playing&nbsp;&nbsp;<span class="twitch-info-game"></span>&nbsp;&nbsp;with <span class="twitch-info-viewers"></span> viewers.</span>
            </a>
        <%- end -%>
        <div class="member-biography"><%= render_markdown @member.biography %></div>
    <% end %>
    <div class="clear"></div>
    <%= user_actions is_admin_or?(@member) do -%>
        <%= action_link_to :settings, 'Edit', edit_member_path(@member)  %>
        <%= action_link_to :link, 'Links', member_external_links_path(@member) %>
        <%= action_link_to 'image-area', 'Backgrounds', member_background_images_path(@member) %>
        <%- if is_admin? then -%>
            <%= action_delete_link 'Delete', @member %>
        <%- end -%>
    <%- end -%>
<%- end -%>

<%= content_row :large, :halfs do -%>
    <%= content_section 'member-games', title: 'Games' do -%>
        <%= render partial: 'game_memberships/list', locals: {assoc: @member} %>
    <%- end -%>
    
    <%= content_section 'member-recent-videos', class: 'hide-small', title: 'Recent Videos' do -%>
        <%= render partial: 'videos/list', locals: {assoc: @member, show_actions: true} %>
    <%- end -%>
<%- end -%>
